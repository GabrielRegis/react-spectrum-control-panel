{"remainingRequest":"/Users/gabrielregis/react-spectrum-control-panel/node_modules/thread-loader/dist/cjs.js??ref--7-1!/Users/gabrielregis/react-spectrum-control-panel/node_modules/babel-loader/lib/index.js??ref--7-2!/Users/gabrielregis/react-spectrum-control-panel/src/services/websocket/socketIO.ts","dependencies":[{"path":"/Users/gabrielregis/react-spectrum-control-panel/src/services/websocket/socketIO.ts","mtime":1560467078000},{"path":"/Users/gabrielregis/react-spectrum-control-panel/node_modules/cache-loader/dist/cjs.js","mtime":1561315137663},{"path":"/Users/gabrielregis/react-spectrum-control-panel/node_modules/thread-loader/dist/cjs.js","mtime":1561315143281},{"path":"/Users/gabrielregis/react-spectrum-control-panel/node_modules/babel-loader/lib/index.js","mtime":1561315137554}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJhbnRkL2xpYi9tZXNzYWdlL3N0eWxlIjsKaW1wb3J0IF9tZXNzYWdlIGZyb20gImFudGQvbGliL21lc3NhZ2UiOwppbXBvcnQgaW8gZnJvbSAnc29ja2V0LmlvLWNsaWVudCc7CmltcG9ydCBzb2NrZXRpb1dpbGRjYXJkIGZyb20gJ3NvY2tldGlvLXdpbGRjYXJkJzsKaW1wb3J0IHsgcmVhY3Rpb24gfSBmcm9tICdtb2J4JzsKaW1wb3J0IHsgc29ja2V0U3RvcmUgfSBmcm9tICdAc3RvcmUvaW5kZXgnOwp2YXIgcGF0Y2ggPSBzb2NrZXRpb1dpbGRjYXJkKGlvLk1hbmFnZXIpOwovKioKICogc29ja2V0IOmAmuS/oQogKgogKiBAZXhwb3J0CiAqIEBjbGFzcyBTb2NrZXQKICovCgpjbGFzcyBTb2NrZXQgewogIGNvbnN0cnVjdG9yKCkgewogICAgdGhpcy5zb2NrZXQgPSB2b2lkIDA7CiAgfQoKICBzZW5kKGV2ZW50LCBkYXRhKSB7CiAgICB2YXIgcmV0cnkgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IDA7CgogICAgaWYgKHRoaXMuc29ja2V0ICYmIHRoaXMuc29ja2V0LmNvbm5lY3RlZCkgewogICAgICB0aGlzLnNvY2tldC5lbWl0KGV2ZW50LCBkYXRhKTsKICAgIH0gZWxzZSBpZiAocmV0cnkgPCAzKSB7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHRoaXMuc2VuZChkYXRhLCByZXRyeSsrKTsKICAgICAgfSwgMzAwKTsKICAgIH0KICB9CgogIG9wZW4odXJsKSB7CiAgICB2YXIgdHJhbnNwb3J0cyA9IFsnd2Vic29ja2V0J107CgogICAgaWYgKCFzb2NrZXRTdG9yZS5ub3RTdXBwb3J0UG9sbGluZykgewogICAgICB0cmFuc3BvcnRzLnVuc2hpZnQoJ3BvbGxpbmcnKTsKICAgIH0KCiAgICB0aGlzLnNvY2tldCA9IGlvLmNvbm5lY3QodXJsLCB7CiAgICAgIHJlY29ubmVjdGlvbkRlbGF5OiAxMDAwLAogICAgICByZWNvbm5lY3Rpb246IHRydWUsCiAgICAgIHJlY29ubmVjdGlvbkF0dGVtcHRzOiA1LAogICAgICB0cmFuc3BvcnRzCiAgICB9KTsKICAgIHBhdGNoKHRoaXMuc29ja2V0KTsKICAgIHJlYWN0aW9uKCgpID0+IHNvY2tldFN0b3JlLnNvY2tldFR5cGUsIChfLCByKSA9PiB7CiAgICAgIHRoaXMuc29ja2V0LmNsb3NlKCk7CiAgICAgIHIuZGlzcG9zZSgpOwogICAgfSk7CiAgICB0aGlzLnNvY2tldC5vbigncmVjb25uZWN0JywgYXR0ZW1wdE51bWJlciA9PiB7CiAgICAgIHZhciB0ZXh0ID0gYHNvY2tldCByZWNvbm5lY3QgYWZ0ZXIgYXR0ZW1wdCAke2F0dGVtcHROdW1iZXJ9IHRpbWVzICEhIWA7CiAgICAgIHNvY2tldFN0b3JlLmFkZE1lc3NhZ2UoewogICAgICAgIGV2ZW50OiAncmVjb25uZWN0JywKICAgICAgICBmcm9tOiAnY29uc29sZScsCiAgICAgICAgZGF0YTogdGV4dAogICAgICB9KTsKICAgIH0pOyAvLyDooqvmlq3lvIAsIOS4jemHjei/ngoKICAgIHRoaXMuc29ja2V0Lm9uKCdkaXNjb25uZWN0JywgcmVhc29uID0+IHsKICAgICAgc29ja2V0U3RvcmUuc2V0U29ja2V0SXNDb25uZWN0ZWQoZmFsc2UpOwogICAgICB2YXIgdGV4dCA9IGBzb2NrZXQgZGlzY29ubmVjdCBiZWNhdXNlOiAke3JlYXNvbn0gISEhYDsKICAgICAgc29ja2V0U3RvcmUuYWRkTWVzc2FnZSh7CiAgICAgICAgZXZlbnQ6ICdkaXNjb25uZWN0JywKICAgICAgICBmcm9tOiAnY29uc29sZScsCiAgICAgICAgZGF0YTogdGV4dAogICAgICB9KTsKICAgIH0pOwogICAgdGhpcy5zb2NrZXQub24oJ2Nvbm5lY3RfdGltZW91dCcsIHRpbWVvdXQgPT4gewogICAgICB2YXIgdGV4dCA9IGBzb2NrZXQgY29ubmVjdF90aW1lb3V0OiAke3RpbWVvdXR9ICEhIWA7CiAgICAgIHNvY2tldFN0b3JlLmFkZE1lc3NhZ2UoewogICAgICAgIGV2ZW50OiAnY29ubmVjdF90aW1lb3V0JywKICAgICAgICBmcm9tOiAnY29uc29sZScsCiAgICAgICAgZGF0YTogdGV4dAogICAgICB9KTsKICAgIH0pOyAvLyDov57mjqXplJnor68KCiAgICB0aGlzLnNvY2tldC5vbignY29ubmVjdF9lcnJvcicsIGVyciA9PiB7CiAgICAgIHZhciB0ZXh0ID0gJ3NvY2tldCBjb25uZWN0X2Vycm9yICEhISc7CiAgICAgIHNvY2tldFN0b3JlLmFkZE1lc3NhZ2UoewogICAgICAgIGV2ZW50OiAnY29ubmVjdF9lcnJvcicsCiAgICAgICAgZnJvbTogJ2NvbnNvbGUnLAogICAgICAgIGRhdGE6IHRleHQKICAgICAgfSk7CiAgICAgIGNvbnNvbGUud2FybihlcnIpOwogICAgfSk7IC8vIOmUmeivr+aNleiOtwoKICAgIHRoaXMuc29ja2V0Lm9uKCdlcnJvcicsIGVyciA9PiB7CiAgICAgIHNvY2tldFN0b3JlLnNldFNvY2tldElzQ29ubmVjdGVkKGZhbHNlKTsKICAgICAgdmFyIHRleHQgPSAnc29ja2V0IGVycm9yICEhISc7CiAgICAgIHNvY2tldFN0b3JlLmFkZE1lc3NhZ2UoewogICAgICAgIGV2ZW50OiAnZXJyb3InLAogICAgICAgIGZyb206ICdjb25zb2xlJywKICAgICAgICBkYXRhOiB0ZXh0CiAgICAgIH0pOwogICAgICBjb25zb2xlLndhcm4oZXJyKTsKICAgIH0pOwogICAgdGhpcy5zb2NrZXQub24oJ2Nvbm5lY3QnLCAoKSA9PiB7CiAgICAgIHNvY2tldFN0b3JlLnNldFNvY2tldElzQ29ubmVjdGVkKHRydWUpOwogICAgICB2YXIgdGV4dCA9ICdzb2NrZXQgY29ubmVjdGVkICEhISc7CiAgICAgIHNvY2tldFN0b3JlLmFkZE1lc3NhZ2UoewogICAgICAgIGV2ZW50OiAnY29ubmVjdCcsCiAgICAgICAgZnJvbTogJ2NvbnNvbGUnLAogICAgICAgIGRhdGE6IHRleHQKICAgICAgfSk7CiAgICB9KTsKICAgIHRoaXMuc29ja2V0Lm9uKCdwaW5nJywgKCkgPT4gewogICAgICBzb2NrZXRTdG9yZS5hZGRNZXNzYWdlKHsKICAgICAgICBldmVudDogJ3BpbmcnLAogICAgICAgIGZyb206ICdicm93c2VyJywKICAgICAgICBkYXRhOiBudWxsCiAgICAgIH0pOwogICAgfSk7CiAgICB0aGlzLnNvY2tldC5vbigncG9uZycsICgpID0+IHsKICAgICAgc29ja2V0U3RvcmUuYWRkTWVzc2FnZSh7CiAgICAgICAgZXZlbnQ6ICdwb25nJywKICAgICAgICBmcm9tOiAnc2VydmVyJywKICAgICAgICBkYXRhOiBudWxsCiAgICAgIH0pOwogICAgfSk7CiAgICB0aGlzLnNvY2tldC5vbignKicsIHBrZyA9PiB7CiAgICAgIGNvbnNvbGUubG9nKCdvbiBhbGwgc29ja2V0IGNhbGxiYWNrOiAnLCBwa2cpOwoKICAgICAgaWYgKHBrZyAmJiBwa2cuZGF0YSBpbnN0YW5jZW9mIEFycmF5ICYmIHBrZy5kYXRhLmxlbmd0aCA+IDEpIHsKICAgICAgICB2YXIgZXZlbnQgPSBwa2cuZGF0YVswXTsKICAgICAgICB2YXIgZGF0YSA9IHBrZy5kYXRhWzFdOwogICAgICAgIHNvY2tldFN0b3JlLmFkZE1lc3NhZ2UoewogICAgICAgICAgZXZlbnQsCiAgICAgICAgICBmcm9tOiAnc2VydmVyJywKICAgICAgICAgIGRhdGEKICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CiAgfQoKfQoKdmFyIHNvY2tldEluc3RhbmNlID0gbmV3IFNvY2tldCgpOwoKZnVuY3Rpb24gY2FuU29ja2V0T3BlbigpIHsKICByZXR1cm4gIShzb2NrZXRJbnN0YW5jZS5zb2NrZXQgJiYgc29ja2V0SW5zdGFuY2Uuc29ja2V0LmNvbm5lY3RlZCk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBzb2NrZXRDb25uZWN0KHVybCkgewogIGlmICghY2FuU29ja2V0T3BlbigpKSB7CiAgICByZXR1cm4gX21lc3NhZ2UuZXJyb3IoJ1BsZWFzZSBkaXNjb25uZWN0IHRoZSBleGlzdGluZyBpbnN0YW5jZSEhIScpOwogIH0KCiAgc29ja2V0SW5zdGFuY2Uub3Blbih1cmwpOwp9CmV4cG9ydCBmdW5jdGlvbiBzb2NrZXREaXNjb25uZWN0KCkgewogIGlmIChzb2NrZXRJbnN0YW5jZS5zb2NrZXQgJiYgc29ja2V0SW5zdGFuY2Uuc29ja2V0LmNvbm5lY3RlZCkgewogICAgc29ja2V0SW5zdGFuY2Uuc29ja2V0LmNsb3NlKCk7CiAgfQp9CmV4cG9ydCBmdW5jdGlvbiBzZW5kKGV2ZW50LCBkYXRhKSB7CiAgaWYgKCFzb2NrZXRJbnN0YW5jZS5zb2NrZXQgfHwgIXNvY2tldEluc3RhbmNlLnNvY2tldC5jb25uZWN0ZWQpIHsKICAgIHJldHVybiBfbWVzc2FnZS5lcnJvcignUGxlYXNlIGNvbm5lY3QgdG8gc2VydmVyISEhJyk7CiAgfQoKICBzb2NrZXRJbnN0YW5jZS5zZW5kKGV2ZW50LCBkYXRhKTsKICBzb2NrZXRTdG9yZS5hZGRNZXNzYWdlKHsKICAgIGV2ZW50LAogICAgZnJvbTogJ2Jyb3dzZXInLAogICAgZGF0YQogIH0pOwp9"},{"version":3,"sources":["/Users/gabrielregis/react-spectrum-control-panel/src/services/websocket/socketIO.ts"],"names":["io","socketioWildcard","reaction","socketStore","patch","Manager","Socket","socket","send","event","data","retry","connected","emit","setTimeout","open","url","transports","notSupportPolling","unshift","connect","reconnectionDelay","reconnection","reconnectionAttempts","socketType","_","r","close","dispose","on","attemptNumber","text","addMessage","from","reason","setSocketIsConnected","timeout","err","console","warn","pkg","log","Array","length","socketInstance","canSocketOpen","socketConnect","error","socketDisconnect"],"mappings":"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","sourcesContent":["import io from 'socket.io-client'\nimport socketioWildcard from 'socketio-wildcard'\nimport { message } from 'antd'\nimport { reaction } from 'mobx'\n\nimport { socketStore } from '@store/index'\n\nconst patch = socketioWildcard(io.Manager)\n\n/**\n * socket 通信\n *\n * @export\n * @class Socket\n */\nclass Socket {\n    socket: SocketIOClient.Socket\n\n    send(event: string, data: any, retry = 0) {\n        if (this.socket && this.socket.connected) {\n            this.socket.emit(event, data)\n        } else if (retry < 3) {\n            setTimeout(() => {\n                this.send(data, retry++)\n            }, 300)\n        }\n    }\n\n    open(url: string) {\n        const transports = ['websocket']\n        if (!socketStore.notSupportPolling) {\n            transports.unshift('polling')\n        }\n        this.socket = io.connect(url, {\n            reconnectionDelay: 1000,\n            reconnection: true,\n            reconnectionAttempts: 5,\n            transports\n        })\n\n        patch(this.socket)\n\n        reaction(\n            () => socketStore.socketType,\n            (_, r) => {\n                this.socket.close()\n                r.dispose()\n            }\n        )\n\n        this.socket.on('reconnect', attemptNumber => {\n            const text = `socket reconnect after attempt ${attemptNumber} times !!!`\n            socketStore.addMessage({\n                event: 'reconnect',\n                from: 'console',\n                data: text\n            })\n        })\n\n        // 被断开, 不重连\n        this.socket.on('disconnect', reason => {\n            socketStore.setSocketIsConnected(false)\n            const text = `socket disconnect because: ${reason} !!!`\n            socketStore.addMessage({\n                event: 'disconnect',\n                from: 'console',\n                data: text\n            })\n        })\n\n        this.socket.on('connect_timeout', timeout => {\n            const text = `socket connect_timeout: ${timeout} !!!`\n            socketStore.addMessage({\n                event: 'connect_timeout',\n                from: 'console',\n                data: text\n            })\n        })\n\n        // 连接错误\n        this.socket.on('connect_error', err => {\n            const text = 'socket connect_error !!!'\n            socketStore.addMessage({\n                event: 'connect_error',\n                from: 'console',\n                data: text\n            })\n            console.warn(err)\n        })\n\n        // 错误捕获\n        this.socket.on('error', err => {\n            socketStore.setSocketIsConnected(false)\n            const text = 'socket error !!!'\n            socketStore.addMessage({\n                event: 'error',\n                from: 'console',\n                data: text\n            })\n            console.warn(err)\n        })\n\n        this.socket.on('connect', () => {\n            socketStore.setSocketIsConnected(true)\n            const text = 'socket connected !!!'\n            socketStore.addMessage({\n                event: 'connect',\n                from: 'console',\n                data: text\n            })\n        })\n\n        this.socket.on('ping', () => {\n            socketStore.addMessage({\n                event: 'ping',\n                from: 'browser',\n                data: null\n            })\n        })\n\n        this.socket.on('pong', () => {\n            socketStore.addMessage({\n                event: 'pong',\n                from: 'server',\n                data: null\n            })\n        })\n\n        this.socket.on('*', pkg => {\n            console.log('on all socket callback: ', pkg)\n            if (pkg && pkg.data instanceof Array && pkg.data.length > 1) {\n                const event = pkg.data[0]\n                const data = pkg.data[1]\n                socketStore.addMessage({\n                    event,\n                    from: 'server',\n                    data\n                })\n            }\n        })\n    }\n}\n\nconst socketInstance = new Socket()\n\nfunction canSocketOpen() {\n    return !(socketInstance.socket && socketInstance.socket.connected)\n}\n\nexport function socketConnect(url: string) {\n    if (!canSocketOpen()) {\n        return message.error('Please disconnect the existing instance!!!')\n    }\n    socketInstance.open(url)\n}\n\nexport function socketDisconnect() {\n    if (socketInstance.socket && socketInstance.socket.connected) {\n        socketInstance.socket.close()\n    }\n}\n\nexport function send(event: string, data: any) {\n    if (!socketInstance.socket || !socketInstance.socket.connected) {\n        return message.error('Please connect to server!!!')\n    }\n    socketInstance.send(event, data)\n    socketStore.addMessage({\n        event,\n        from: 'browser',\n        data\n    })\n}\n"]}]}