{"remainingRequest":"/Users/gabrielregis/react-spectrum-control-panel/node_modules/thread-loader/dist/cjs.js??ref--7-1!/Users/gabrielregis/react-spectrum-control-panel/node_modules/babel-loader/lib/index.js??ref--7-2!/Users/gabrielregis/react-spectrum-control-panel/src/store/authStore/index.ts","dependencies":[{"path":"/Users/gabrielregis/react-spectrum-control-panel/src/store/authStore/index.ts","mtime":1560467078000},{"path":"/Users/gabrielregis/react-spectrum-control-panel/node_modules/cache-loader/dist/cjs.js","mtime":1561315137663},{"path":"/Users/gabrielregis/react-spectrum-control-panel/node_modules/thread-loader/dist/cjs.js","mtime":1561315143281},{"path":"/Users/gabrielregis/react-spectrum-control-panel/node_modules/babel-loader/lib/index.js","mtime":1561315137554}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXM2LnByb21pc2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLml0ZXJhYmxlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXM2Lm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzNi5yZWdleHAucmVwbGFjZSI7Cgp2YXIgX2NsYXNzLCBfZGVzY3JpcHRvciwgX2Rlc2NyaXB0b3IyLCBfZGVzY3JpcHRvcjMsIF90ZW1wOwoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgeyB0cnkgeyB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7IHZhciB2YWx1ZSA9IGluZm8udmFsdWU7IH0gY2F0Y2ggKGVycm9yKSB7IHJlamVjdChlcnJvcik7IHJldHVybjsgfSBpZiAoaW5mby5kb25lKSB7IHJlc29sdmUodmFsdWUpOyB9IGVsc2UgeyBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7IH0gfQoKZnVuY3Rpb24gX2FzeW5jVG9HZW5lcmF0b3IoZm4pIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgdmFyIHNlbGYgPSB0aGlzLCBhcmdzID0gYXJndW1lbnRzOyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2YXIgZ2VuID0gZm4uYXBwbHkoc2VsZiwgYXJncyk7IGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgIm5leHQiLCB2YWx1ZSk7IH0gZnVuY3Rpb24gX3Rocm93KGVycikgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJ0aHJvdyIsIGVycik7IH0gX25leHQodW5kZWZpbmVkKTsgfSk7IH07IH0KCmZ1bmN0aW9uIF9pbml0aWFsaXplckRlZmluZVByb3BlcnR5KHRhcmdldCwgcHJvcGVydHksIGRlc2NyaXB0b3IsIGNvbnRleHQpIHsgaWYgKCFkZXNjcmlwdG9yKSByZXR1cm47IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHByb3BlcnR5LCB7IGVudW1lcmFibGU6IGRlc2NyaXB0b3IuZW51bWVyYWJsZSwgY29uZmlndXJhYmxlOiBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSwgd3JpdGFibGU6IGRlc2NyaXB0b3Iud3JpdGFibGUsIHZhbHVlOiBkZXNjcmlwdG9yLmluaXRpYWxpemVyID8gZGVzY3JpcHRvci5pbml0aWFsaXplci5jYWxsKGNvbnRleHQpIDogdm9pZCAwIH0pOyB9CgpmdW5jdGlvbiBfYXBwbHlEZWNvcmF0ZWREZXNjcmlwdG9yKHRhcmdldCwgcHJvcGVydHksIGRlY29yYXRvcnMsIGRlc2NyaXB0b3IsIGNvbnRleHQpIHsgdmFyIGRlc2MgPSB7fTsgT2JqZWN0LmtleXMoZGVzY3JpcHRvcikuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IGRlc2Nba2V5XSA9IGRlc2NyaXB0b3Jba2V5XTsgfSk7IGRlc2MuZW51bWVyYWJsZSA9ICEhZGVzYy5lbnVtZXJhYmxlOyBkZXNjLmNvbmZpZ3VyYWJsZSA9ICEhZGVzYy5jb25maWd1cmFibGU7IGlmICgndmFsdWUnIGluIGRlc2MgfHwgZGVzYy5pbml0aWFsaXplcikgeyBkZXNjLndyaXRhYmxlID0gdHJ1ZTsgfSBkZXNjID0gZGVjb3JhdG9ycy5zbGljZSgpLnJldmVyc2UoKS5yZWR1Y2UoZnVuY3Rpb24gKGRlc2MsIGRlY29yYXRvcikgeyByZXR1cm4gZGVjb3JhdG9yKHRhcmdldCwgcHJvcGVydHksIGRlc2MpIHx8IGRlc2M7IH0sIGRlc2MpOyBpZiAoY29udGV4dCAmJiBkZXNjLmluaXRpYWxpemVyICE9PSB2b2lkIDApIHsgZGVzYy52YWx1ZSA9IGRlc2MuaW5pdGlhbGl6ZXIgPyBkZXNjLmluaXRpYWxpemVyLmNhbGwoY29udGV4dCkgOiB2b2lkIDA7IGRlc2MuaW5pdGlhbGl6ZXIgPSB1bmRlZmluZWQ7IH0gaWYgKGRlc2MuaW5pdGlhbGl6ZXIgPT09IHZvaWQgMCkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eSwgZGVzYyk7IGRlc2MgPSBudWxsOyB9IHJldHVybiBkZXNjOyB9CgpmdW5jdGlvbiBfaW5pdGlhbGl6ZXJXYXJuaW5nSGVscGVyKGRlc2NyaXB0b3IsIGNvbnRleHQpIHsgdGhyb3cgbmV3IEVycm9yKCdEZWNvcmF0aW5nIGNsYXNzIHByb3BlcnR5IGZhaWxlZC4gUGxlYXNlIGVuc3VyZSB0aGF0ICcgKyAncHJvcG9zYWwtY2xhc3MtcHJvcGVydGllcyBpcyBlbmFibGVkIGFuZCBzZXQgdG8gdXNlIGxvb3NlIG1vZGUuICcgKyAnVG8gdXNlIHByb3Bvc2FsLWNsYXNzLXByb3BlcnRpZXMgaW4gc3BlYyBtb2RlIHdpdGggZGVjb3JhdG9ycywgd2FpdCBmb3IgJyArICd0aGUgbmV4dCBtYWpvciB2ZXJzaW9uIG9mIGRlY29yYXRvcnMgaW4gc3RhZ2UgMi4nKTsgfQoKaW1wb3J0IHsgb2JzZXJ2YWJsZSwgYWN0aW9uLCByZWFjdGlvbiB9IGZyb20gJ21vYngnOwppbXBvcnQgeyBpc1BsYWluT2JqZWN0IH0gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IHsgU3RvcmVFeHQgfSBmcm9tICdAdXRpbHMvcmVhY3RFeHQnOwppbXBvcnQgeyByb3V0ZXJTdG9yZSB9IGZyb20gJy4vLi4vJzsKaW1wb3J0IHsgaW5pdGlhbFVzZXJJbmZvLCBzeW5jVXNlckluZm8gfSBmcm9tICcuL3N5bmNVc2VySW5mbyc7CmltcG9ydCB7IExPQ0FMU1RPUkFHRV9LRVlTIH0gZnJvbSAnQGNvbnN0YW50cy9pbmRleCc7CmV4cG9ydCB2YXIgQXV0aFN0b3JlID0gKF9jbGFzcyA9IChfdGVtcCA9IGNsYXNzIEF1dGhTdG9yZSBleHRlbmRzIFN0b3JlRXh0IHsKICAvKioKICAgKiDnlKjmiLfkv6Hmga8KICAgKgogICAqIEB0eXBlIHtJQXV0aFN0b3JlLlVzZXJJbmZvfQogICAqIEBtZW1iZXJvZiBBdXRoU3RvcmUKICAgKi8KICBjb25zdHJ1Y3RvcigpIHsKICAgIHN1cGVyKCk7CgogICAgX2luaXRpYWxpemVyRGVmaW5lUHJvcGVydHkodGhpcywgInVzZXJJbmZvIiwgX2Rlc2NyaXB0b3IsIHRoaXMpOwoKICAgIF9pbml0aWFsaXplckRlZmluZVByb3BlcnR5KHRoaXMsICJsb2dpbiIsIF9kZXNjcmlwdG9yMiwgdGhpcyk7CgogICAgdGhpcy5sb2dvdXQgPSAoKSA9PiB7CiAgICAgIHRoaXMuc2V0VXNlckluZm8oe30pOwogICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShMT0NBTFNUT1JBR0VfS0VZUy5VU0VSSU5GTyk7CiAgICAgIHJvdXRlclN0b3JlLnJlcGxhY2UoJy9sb2dpbicpOwogICAgfTsKCiAgICBfaW5pdGlhbGl6ZXJEZWZpbmVQcm9wZXJ0eSh0aGlzLCAic2V0VXNlckluZm8iLCBfZGVzY3JpcHRvcjMsIHRoaXMpOwoKICAgIHJlYWN0aW9uKCgpID0+IHRoaXMudXNlckluZm8sIHN5bmNVc2VySW5mbyk7CiAgfQoKfSwgX3RlbXApLCAoX2Rlc2NyaXB0b3IgPSBfYXBwbHlEZWNvcmF0ZWREZXNjcmlwdG9yKF9jbGFzcy5wcm90b3R5cGUsICJ1c2VySW5mbyIsIFtvYnNlcnZhYmxlXSwgewogIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICBlbnVtZXJhYmxlOiB0cnVlLAogIHdyaXRhYmxlOiB0cnVlLAogIGluaXRpYWxpemVyOiBmdW5jdGlvbiBpbml0aWFsaXplcigpIHsKICAgIHJldHVybiBpbml0aWFsVXNlckluZm87CiAgfQp9KSwgX2Rlc2NyaXB0b3IyID0gX2FwcGx5RGVjb3JhdGVkRGVzY3JpcHRvcihfY2xhc3MucHJvdG90eXBlLCAibG9naW4iLCBbYWN0aW9uXSwgewogIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICBlbnVtZXJhYmxlOiB0cnVlLAogIHdyaXRhYmxlOiB0cnVlLAogIGluaXRpYWxpemVyOiBmdW5jdGlvbiBpbml0aWFsaXplcigpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgcmV0dXJuICgKICAgICAgLyojX19QVVJFX18qLwogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShwYXJhbXMpIHsKICAgICAgICAgIHZhciByZXM7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAwOwogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmFwaS5hdXRoLmxvZ2luKHBhcmFtcyk7CgogICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICByZXMgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0VXNlckluZm8oaXNQbGFpbk9iamVjdChyZXMpID8gcmVzIDoge30pOwoKICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oTE9DQUxTVE9SQUdFX0tFWVMuVVNFUklORk8sIEpTT04uc3RyaW5naWZ5KHJlcykpOwogICAgICAgICAgICAgICAgICByb3V0ZXJTdG9yZS5yZXBsYWNlKCcvJyk7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gOTsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgwKTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihfY29udGV4dC50MCk7CgogICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzAsIDldXSk7CiAgICAgICAgfSkpOwoKICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94KSB7CiAgICAgICAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIH07CiAgICAgIH0oKQogICAgKTsKICB9Cn0pLCBfZGVzY3JpcHRvcjMgPSBfYXBwbHlEZWNvcmF0ZWREZXNjcmlwdG9yKF9jbGFzcy5wcm90b3R5cGUsICJzZXRVc2VySW5mbyIsIFthY3Rpb25dLCB7CiAgY29uZmlndXJhYmxlOiB0cnVlLAogIGVudW1lcmFibGU6IHRydWUsCiAgd3JpdGFibGU6IHRydWUsCiAgaW5pdGlhbGl6ZXI6IGZ1bmN0aW9uIGluaXRpYWxpemVyKCkgewogICAgcmV0dXJuIHVzZXJJbmZvID0+IHsKICAgICAgdGhpcy51c2VySW5mbyA9IHVzZXJJbmZvOwogICAgICByZXR1cm4gdXNlckluZm87CiAgICB9OwogIH0KfSkpLCBfY2xhc3MpOwpleHBvcnQgZGVmYXVsdCBuZXcgQXV0aFN0b3JlKCk7"},{"version":3,"sources":["/Users/gabrielregis/react-spectrum-control-panel/src/store/authStore/index.ts"],"names":["observable","action","reaction","isPlainObject","StoreExt","routerStore","initialUserInfo","syncUserInfo","LOCALSTORAGE_KEYS","AuthStore","constructor","logout","setUserInfo","localStorage","removeItem","USERINFO","replace","userInfo","params","api","auth","login","res","setItem","JSON","stringify","console","error"],"mappings":";;;;;;;;;;;;;;;;;;AAAA,SAASA,UAAT,EAAqBC,MAArB,EAA6BC,QAA7B,QAA6C,MAA7C;AACA,SAASC,aAAT,QAA8B,QAA9B;AAEA,SAASC,QAAT,QAAyB,iBAAzB;AACA,SAASC,WAAT,QAA4B,OAA5B;AACA,SAASC,eAAT,EAA0BC,YAA1B,QAA8C,gBAA9C;AACA,SAASC,iBAAT,QAAkC,kBAAlC;AAEA,WAAaC,SAAb,sBAAO,MAAMA,SAAN,SAAwBL,QAAxB,CAAiC;AACpC;;;;;;AASAM,EAAAA,WAAW,GAAG;AACV;;AADU;;AAAA;;AAAA,SAiBdC,MAjBc,GAiBL,MAAM;AACX,WAAKC,WAAL,CAAiB,EAAjB;AACAC,MAAAA,YAAY,CAACC,UAAb,CAAwBN,iBAAiB,CAACO,QAA1C;AACAV,MAAAA,WAAW,CAACW,OAAZ,CAAoB,QAApB;AACH,KArBa;;AAAA;;AAEVd,IAAAA,QAAQ,CAAC,MAAM,KAAKe,QAAZ,EAAsBV,YAAtB,CAAR;AACH;;AAbmC,CAAxC,kFAOKP,UAPL;AAAA;AAAA;AAAA;AAAA;AAAA,WAQoCM,eARpC;AAAA;AAAA,yEAeKL,MAfL;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gCAgBY,iBAAOiB,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAEkB,KAAI,CAACC,GAAL,CAASC,IAAT,CAAcC,KAAd,CAAoBH,MAApB,CAFlB;;AAAA;AAEMI,kBAAAA,GAFN;;AAGA,kBAAA,KAAI,CAACV,WAAL,CAAiBT,aAAa,CAACmB,GAAD,CAAb,GAAqBA,GAArB,GAA2B,EAA5C;;AACAT,kBAAAA,YAAY,CAACU,OAAb,CAAqBf,iBAAiB,CAACO,QAAvC,EAAiDS,IAAI,CAACC,SAAL,CAAeH,GAAf,CAAjD;AACAjB,kBAAAA,WAAW,CAACW,OAAZ,CAAoB,GAApB;AALA;AAAA;;AAAA;AAAA;AAAA;AAOAU,kBAAAA,OAAO,CAACC,KAAR;;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAhBZ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+EAsCK1B,MAtCL;AAAA;AAAA;AAAA;AAAA;AAAA,WAuCmBgB,QAAD,IAAwD;AAClE,WAAKA,QAAL,GAAgBA,QAAhB;AACA,aAAOA,QAAP;AACH,KA1CL;AAAA;AAAA;AA6CA,eAAe,IAAIR,SAAJ,EAAf","sourcesContent":["import { observable, action, reaction } from 'mobx'\nimport { isPlainObject } from 'lodash'\n\nimport { StoreExt } from '@utils/reactExt'\nimport { routerStore } from './../'\nimport { initialUserInfo, syncUserInfo } from './syncUserInfo'\nimport { LOCALSTORAGE_KEYS } from '@constants/index'\n\nexport class AuthStore extends StoreExt {\n    /**\n     * 用户信息\n     *\n     * @type {IAuthStore.UserInfo}\n     * @memberof AuthStore\n     */\n    @observable\n    userInfo: IAuthStore.UserInfo = initialUserInfo\n\n    constructor() {\n        super()\n        reaction(() => this.userInfo, syncUserInfo)\n    }\n\n    @action\n    login = async (params: IAuthStore.LoginParams): Promise<any> => {\n        try {\n            const res = await this.api.auth.login(params)\n            this.setUserInfo(isPlainObject(res) ? res : {})\n            localStorage.setItem(LOCALSTORAGE_KEYS.USERINFO, JSON.stringify(res))\n            routerStore.replace('/')\n        } catch (err) {\n            console.error(err)\n        }\n    }\n\n    logout = () => {\n        this.setUserInfo({})\n        localStorage.removeItem(LOCALSTORAGE_KEYS.USERINFO)\n        routerStore.replace('/login')\n    }\n\n    /**\n     * 初始化用户信息\n     *\n     * @memberof AuthStore\n     */\n    @action\n    setUserInfo = (userInfo: IAuthStore.UserInfo): IAuthStore.UserInfo => {\n        this.userInfo = userInfo\n        return userInfo\n    }\n}\n\nexport default new AuthStore()\n"]}]}